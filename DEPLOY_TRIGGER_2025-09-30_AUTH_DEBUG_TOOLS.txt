DEPLOYMENT TRIGGER - Authentication Debug Tools
==============================================
Date: 2025-09-30
Time: 11:20 AM PST
Commit: cf14265

CURRENT UNDERSTANDING:
---------------------
1. The app uses a unified domain: aiblueprint.higheredaiblueprint.com
2. Both K-12 and Higher Ed services share this domain
3. Users choose their path on /start page
4. Production environment is correctly detected
5. Supabase connection works but "profiles" table doesn't exist

CHANGES DEPLOYED:
-----------------

1. Updated /api/test-connection:
   - Changed to test 'user_payments' table instead of 'profiles'
   - Added table name to response for clarity
   - This should now return success if database is accessible

2. Added /api/test-auth endpoint:
   - POST endpoint to test authentication directly
   - Clears session before attempting login
   - Returns detailed information about the auth attempt
   - Can be tested with curl or Postman

TESTING INSTRUCTIONS:
--------------------

1. Test Database Connection:
   curl https://aiblueprint.higheredaiblueprint.com/api/test-connection
   
   Should show:
   - success: true
   - databaseTest.success: true (if user_payments table exists)

2. Test Authentication API:
   curl -X POST https://aiblueprint.higheredaiblueprint.com/api/test-auth \
     -H "Content-Type: application/json" \
     -d '{"email":"test@aiblueprint.com","password":"TestPassword123!"}'
   
   This will show exactly what happens during authentication.

3. Browser Testing:
   - Visit /test-direct-auth for UI-based testing
   - Check browser console for detailed logs
   - Look for any CORS errors or network issues

POTENTIAL ISSUES TO CHECK:
-------------------------
1. If auth succeeds in API but fails in UI:
   - Session storage issue
   - Cookie configuration
   - CORS settings

2. If auth fails in API:
   - Wrong credentials
   - User doesn't exist
   - Supabase auth configuration

3. If connection test shows database error:
   - Database not properly initialized
   - RLS policies blocking access
   - Missing tables

NEXT STEPS:
-----------
1. Run the test endpoints after deployment
2. Check if authentication works at API level
3. If API works but UI doesn't, focus on client-side session handling
4. If API fails, check Supabase dashboard for user existence